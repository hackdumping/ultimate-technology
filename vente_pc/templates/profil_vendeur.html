{% load static %}
{% include 'metadata.html' %}
<style>
    /* Profil */
.profile-container {
    padding: 40px 20px;
  }

  .profile-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
    gap: 20px;
    margin-bottom: 40px;
  }

  .card {
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    box-shadow: 0 4px 10px rgba(0,0,0,0.08);
  }

  .card h2 {
    margin-bottom: 15px;
    color: #0B7285;
  }

  .info-item {
    margin-bottom: 3px;
    font-size: 15px;
  }

  .edit-profile form {
    display: flex;
    flex-direction: column;
  }

  .edit-profile label {
    /*margin: 10px 0 5px;*/
    font-weight: bold;
    margin-bottom:0;
  }

  .edit-profile input {
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 6px;
  }

  .btn {
    margin-top: 20px;
    padding: 12px;
    background: #0EA5A4;
    color: #fff;
    font-weight: bold;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s;
  }

  .btn:hover {
    background: #0B7285;
  }

  .info-item{
    color : var(--text);
  }
  .card{
    background: var(--card);
  }
#modif input {
    background : var(--bg);
    color : var(--text);
}
</style>
<body>
{% include 'header.html' %}
  <!-- Contenu principal -->
  <main class="container profile-container">
      <div style="text-align:center">
          <img src="{{ vendeur.logo.url }}" style="width:13rem;height:13rem;border-radius:6rem;box-shadow: var(--shadow);" />
          <h1>Mon Profil</h1>
      </div>

    <div class="profile-grid">
      <!-- Informations de l'entreprise -->
      <section class="card profile-info">
        <h2>Informations de l’entreprise</h2>
        <div class="info-item" translate="no" ><strong>Nom : </strong>{{ vendeur.nom }}</div>
        <div class="info-item"><strong>WhatsApp : </strong>{{ vendeur.tel }}</div>
        <div class="info-item"><strong>Email : </strong>{{ vendeur.email }}</div>
        <div class="info-item"><strong>Frais de livraison : </strong>{{ vendeur.frais }} XAF</div>
      </section>

      <!-- Forfait -->
      <section class="card profile-plan">
        <h2>Mon Forfait</h2>
        <div class="info-item"><strong>Type : </strong> {{ vendeur.forfait.nom }} ({{ vendeur.forfait.prix }} XAF/mois)</div>
        <div class="info-item"><strong>Date d’expiration : </strong> <span id="expiration-date">{{ vendeurdate_exp|default:"Non defini"}}</span></div>
        <div class="info-item"><strong>Jours restants : </strong> <span id="days-left">{{ vendeur.jours }}</span> jours</div>
      </section>
    </div>

    <!-- Formulaire édition -->
    <section class="card edit-profile">
      <h2>Éditer mon profil</h2>
      <p style="color: green; font-size : 0.9rem; margin-bottom:25px; margin-top:25px;text-align:center">{{ msg }}</p>
      <form id="modif" method="POST" enctype="multipart/form-data">
          {% csrf_token %}
        <label for="name">Nom de la société</label>
        <input type="text" id="name" name="nom" value="{{ vendeur.nom }}" required>
        <input type="hidden" id="id" name="id" value="{{ vendeur.id }}" required>

        <label for="email">Adresse e-mail</label>
        <input type="email" id="email" name="email" value="{{ vendeur.email }}" required>

        <label for="whatsapp">Numéro WhatsApp</label>
        <input type="text" id="whatsapp" name="tel" value="{{ vendeur.tel }}" required>

        <label for="delivery">Frais de livraison</label>
        <input type="number" id="delivery" name="frais" value="{{ vendeur.frais }}" required>

        <label for="password">Nouveau mot de passe</label>
        <input type="text" id="password" name="mdp" value="{{ vendeur.mdp }}" required>

        <label for="pays">Pays</label>
        <input type="text" id="pays" name="pays" value="{{ vendeur.pays.nom }}" required>

        <label for="ville">Ville</label>
        <input type="text" id="ville" name="ville" value="{{ vendeur.ville.nom }}" required>

        <label for="ville">Logo</label>
        <input type="file" id="logo" name="logo" value="">


        <button type="submit" class="btn">Enregistrer les modifications</button>
      </form>
    </section>
  </main>

  <!-- Footer -->
  {% include 'footer.html' %}
<script src="{% static 'js/source.js' %}" ></script>
  <script>

   if (window.history.replaceState) {
      window.history.replaceState(null, null, window.location.href);
   }
    // Mobile nav
    document.querySelector('.mobile-menu-btn').addEventListener('click',()=>document.getElementById('mobileNav').classList.add('open'));
    document.getElementById('closeMobileNav').addEventListener('click',()=>document.getElementById('mobileNav').classList.remove('open'));
    document.addEventListener('click', function(event){
      if(!document.getElementById('mobileNav').contains(event.target) && event.target !== document.querySelector('.mobile-menu-btn')){
        document.getElementById('mobileNav').classList.remove('open');
      }
    });
      // Calcul des jours restants
/*document.addEventListener("DOMContentLoaded", () => {
    const expirationDate = document.getElementById("expiration-date");
    const daysLeft = document.getElementById("days-left");

    if (expirationDate && daysLeft) {
      const today = new Date();
      const expDate = new Date(expirationDate.textContent);
      const diffTime = expDate - today;
      const diffDays = Math.max(0, Math.ceil(diffTime / (1000 * 60 * 60 * 24)));
      daysLeft.textContent = diffDays;
    }
  }); */

          // Masquer le panier
    panier = document.getElementById('cartBtn');
    panier.style.display = 'none';

  </script>
</body>
</html>
